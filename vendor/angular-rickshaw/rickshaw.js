"use strict";angular.module("angular-rickshaw",[]).directive("rickshaw",["$compile","$window",function(e,r){return{restrict:"EA",scope:{options:"=rickshawOptions",series:"=rickshawSeries",features:"=rickshawFeatures"},link:function(a,i){function t(){h.setSize(),h.render()}function s(){if(h?(l=angular.copy(a.options,l),l.element=o[0],l.series=a.series,h.configure(l)):(n=angular.element(i),n.append(o),n.empty(),o=e("<div></div>")(a),n.append(o),l=angular.copy(a.options),l.element=o[0],l.series=a.series,h=new Rickshaw.Graph(l)),a.features){if(a.features.hover){var r={graph:h};r.xFormatter=a.features.hover.xFormatter,r.yFormatter=a.features.hover.yFormatter,r.formatter=a.features.hover.formatter;{new Rickshaw.Graph.HoverDetail(r)}}if(a.features.palette)for(var s=new Rickshaw.Color.Palette({scheme:a.features.palette}),w=0;w<l.series.length;w++)l.series[w].color=s.color()}if(t(),a.features){if(a.features.xAxis){var g={graph:h};if(a.features.xAxis.timeUnit){var p=new Rickshaw.Fixtures.Time;g.timeUnit=p.unit(a.features.xAxis.timeUnit),c||(c=new Rickshaw.Graph.Axis.Time(g),c.render())}else c||(c=new Rickshaw.Graph.Axis.X(g),c.render())}if(a.features.yAxis){var d={graph:h};a.features.yAxis.tickFormat&&(d.tickFormat=Rickshaw.Fixtures.Number[a.features.yAxis.tickFormat]),f||(f=new Rickshaw.Graph.Axis.Y(d),f.render())}if(a.features.legend){if(!u){u=e("<div></div>")(a),n.append(u);var m=new Rickshaw.Graph.Legend({graph:h,element:u[0]});if(a.features.legend.toggle){new Rickshaw.Graph.Behavior.Series.Toggle({graph:h,legend:m})}if(a.features.legend.highlight){new Rickshaw.Graph.Behavior.Series.Highlight({graph:h,legend:m})}}}else u&&(u.remove(),u=null)}}var n,o,u,c,f,h,l,w=a.$watch("options",function(e,r){angular.equals(e,r)||s()},!0),g=a.$watch(function(e){if(e.features&&e.features.directive&&e.features.directive.watchAllSeries){for(var r={},a=0;a<e.series.length;a++)r["series"+a]=e.series[a].data;return r}return e.series[0].data},function(e,r){angular.equals(e,r)||s()},!0),p=a.$watch("features",function(e,r){angular.equals(e,r)||s()},!0);a.$on("$destroy",function(){w(),g(),p()}),angular.element(r).on("resize",function(){a.$broadcast("rickshaw::resize")}),a.$on("rickshaw::resize",function(){t()}),s()},controller:function(){}}}]);